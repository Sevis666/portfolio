<% if @section.has_subtitle? %>
    <h2 class="section-subtitle"><%= @section.subtitle %></h2>
<% end %>

<% subsections = @section.subsections %>
<% if subsections %>
    <% subsections.each do |sub| %>
        <%= render "shared/subsection", subsection: sub %>
    <% end %>
<% end %>

<% posts = @section.fetch_posts(params[:page]) %>
<% with_location = @section.display.nil? || @section.display.split(':').include?('global') %>
<% if posts %>
    <% posts.each do |p| %>
        <%= render "shared/post", post: p, with_title: true, with_location: with_location %>
    <% end %>
<% end %>

<% next_posts = @section.fetch_next_posts(params[:page]) %>
<% unless next_posts.empty? %>
    <div class="related-posts-box">
        <div class="top-button-wrapper">
            <%= link_to "Show more", @section.link_to_next_page(params[:page]), class: "top-button" %>
        </div>
        <% next_posts.each do |p| %>
            <div class="related-post">
                <h2 class="title"><%= link_to p.printable_name, p.link %></h2>
                <p class="location">Posted in <%= link_to p.location, p.link %></p>
            </div>
        <% end %>
    </div>
<% end %>
